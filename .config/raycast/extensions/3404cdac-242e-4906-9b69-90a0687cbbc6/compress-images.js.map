{
  "version": 3,
  "sources": ["../src/compress-images.ts", "../src/utils/check-install.ts"],
  "sourcesContent": ["import { showToast, Toast, getSelectedFinderItems } from \"@raycast/api\";\nimport { exec } from \"child_process\";\nimport { checkImageOptimInstallation } from \"./utils/check-install\";\n\nexport default async function main() {\n  console.log(\"Starting image compression process\");\n\n  if (!(await checkImageOptimInstallation())) {\n    console.log(\"ImageOptim is not installed. Exiting.\");\n    return;\n  }\n\n  try {\n    const filePaths = (await getSelectedFinderItems()).map((f) => f.path);\n    console.log(`Selected file paths: ${filePaths.join(\", \")}`);\n\n    if (filePaths.length === 0) {\n      console.log(\"No Finder items selected\");\n      await showToast({\n        style: Toast.Style.Failure,\n        title: \"No Finder items selected\",\n        message: \"Please select files in Finder and try again\",\n      });\n      return;\n    }\n\n    console.log(\"Showing compression start toast\");\n    await showToast({\n      style: Toast.Style.Animated,\n      title: \"Compressing with ImageOptim\",\n    });\n\n    const escapedPaths = filePaths.map((path) => `\"${path.replace(/\"/g, '\\\\\"')}\"`).join(\" \");\n    console.log(`Executing ImageOptim with paths: ${escapedPaths}`);\n\n    await new Promise((resolve, reject) => {\n      const process = exec(`/Applications/ImageOptim.app/Contents/MacOS/ImageOptim ${escapedPaths}`, {\n        shell: \"/bin/bash\",\n        timeout: 300000, // 5 minutes timeout\n      });\n\n      process.on(\"exit\", (code) => {\n        if (code === 0) {\n          console.log(\"ImageOptim process completed successfully\");\n          resolve(null);\n        } else {\n          reject(new Error(`ImageOptim process exited with code ${code}`));\n        }\n      });\n\n      process.on(\"error\", (error) => {\n        reject(error);\n      });\n    });\n\n    console.log(\"Compression completed successfully\");\n    await showToast({\n      style: Toast.Style.Success,\n      title: \"Compression Complete\",\n      message: \"Images have been optimized\",\n    });\n  } catch (error) {\n    console.error(\"An error occurred:\", error);\n\n    if (error instanceof Error && error.message.includes(\"Finder isn't the frontmost application\")) {\n      await showToast({\n        style: Toast.Style.Failure,\n        title: \"Finder is not active\",\n        message: \"Please switch to Finder and select files\",\n      });\n    } else {\n      await showToast({\n        style: Toast.Style.Failure,\n        title: \"Operation Failed\",\n        message: \"An unexpected error occurred\",\n      });\n    }\n  }\n}\n", "import { getApplications, showToast, Toast, open } from \"@raycast/api\";\n\nasync function isImageOptimInstalled() {\n  const applications = await getApplications();\n  return applications.some(({ bundleId }) => bundleId === \"net.pornel.ImageOptim\");\n}\n\nexport async function checkImageOptimInstallation(): Promise<boolean> {\n  const isInstalled = await isImageOptimInstalled();\n  if (!isInstalled) {\n    const options: Toast.Options = {\n      style: Toast.Style.Failure,\n      title: \"ImageOptim is not installed.\",\n      message: \"Install it from: https://imageoptim.com/mac\",\n      primaryAction: {\n        title: \"Go to https://imageoptim.com/mac\",\n        onAction: (toast) => {\n          open(\"https://imageoptim.com/mac\");\n          toast.hide();\n        },\n      },\n    };\n\n    await showToast(options);\n  }\n  return isInstalled;\n}\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GAAA,IAAAI,EAAyD,wBACzDC,EAAqB,yBCDrB,IAAAC,EAAwD,wBAExD,eAAeC,GAAwB,CAErC,OADqB,QAAM,mBAAgB,GACvB,KAAK,CAAC,CAAE,SAAAC,CAAS,IAAMA,IAAa,uBAAuB,CACjF,CAEA,eAAsBC,GAAgD,CACpE,IAAMC,EAAc,MAAMH,EAAsB,EAChD,GAAI,CAACG,EAAa,CAChB,IAAMC,EAAyB,CAC7B,MAAO,QAAM,MAAM,QACnB,MAAO,+BACP,QAAS,8CACT,cAAe,CACb,MAAO,mCACP,SAAWC,GAAU,IACnB,QAAK,4BAA4B,EACjCA,EAAM,KAAK,CACb,CACF,CACF,EAEA,QAAM,aAAUD,CAAO,CACzB,CACA,OAAOD,CACT,CDtBA,eAAOG,GAA8B,CAGnC,GAFA,QAAQ,IAAI,oCAAoC,EAE5C,CAAE,MAAMC,EAA4B,EAAI,CAC1C,QAAQ,IAAI,uCAAuC,EACnD,MACF,CAEA,GAAI,CACF,IAAMC,GAAa,QAAM,0BAAuB,GAAG,IAAKC,GAAMA,EAAE,IAAI,EAGpE,GAFA,QAAQ,IAAI,wBAAwBD,EAAU,KAAK,IAAI,CAAC,EAAE,EAEtDA,EAAU,SAAW,EAAG,CAC1B,QAAQ,IAAI,0BAA0B,EACtC,QAAM,aAAU,CACd,MAAO,QAAM,MAAM,QACnB,MAAO,2BACP,QAAS,6CACX,CAAC,EACD,MACF,CAEA,QAAQ,IAAI,iCAAiC,EAC7C,QAAM,aAAU,CACd,MAAO,QAAM,MAAM,SACnB,MAAO,6BACT,CAAC,EAED,IAAME,EAAeF,EAAU,IAAKG,GAAS,IAAIA,EAAK,QAAQ,KAAM,KAAK,CAAC,GAAG,EAAE,KAAK,GAAG,EACvF,QAAQ,IAAI,oCAAoCD,CAAY,EAAE,EAE9D,MAAM,IAAI,QAAQ,CAACE,EAASC,IAAW,CACrC,IAAMC,KAAU,QAAK,0DAA0DJ,CAAY,GAAI,CAC7F,MAAO,YACP,QAAS,GACX,CAAC,EAEDI,EAAQ,GAAG,OAASC,GAAS,CACvBA,IAAS,GACX,QAAQ,IAAI,2CAA2C,EACvDH,EAAQ,IAAI,GAEZC,EAAO,IAAI,MAAM,uCAAuCE,CAAI,EAAE,CAAC,CAEnE,CAAC,EAEDD,EAAQ,GAAG,QAAUE,GAAU,CAC7BH,EAAOG,CAAK,CACd,CAAC,CACH,CAAC,EAED,QAAQ,IAAI,oCAAoC,EAChD,QAAM,aAAU,CACd,MAAO,QAAM,MAAM,QACnB,MAAO,uBACP,QAAS,4BACX,CAAC,CACH,OAASA,EAAO,CACd,QAAQ,MAAM,qBAAsBA,CAAK,EAErCA,aAAiB,OAASA,EAAM,QAAQ,SAAS,wCAAwC,EAC3F,QAAM,aAAU,CACd,MAAO,QAAM,MAAM,QACnB,MAAO,uBACP,QAAS,0CACX,CAAC,EAED,QAAM,aAAU,CACd,MAAO,QAAM,MAAM,QACnB,MAAO,mBACP,QAAS,8BACX,CAAC,CAEL,CACF",
  "names": ["compress_images_exports", "__export", "main", "__toCommonJS", "import_api", "import_child_process", "import_api", "isImageOptimInstalled", "bundleId", "checkImageOptimInstallation", "isInstalled", "options", "toast", "main", "checkImageOptimInstallation", "filePaths", "f", "escapedPaths", "path", "resolve", "reject", "process", "code", "error"]
}
