"use strict";var R=Object.create;var A=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var q=Object.getPrototypeOf,B=Object.prototype.hasOwnProperty;var J=(n,e)=>{for(var t in e)A(n,t,{get:e[t],enumerable:!0})},x=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of V(e))!B.call(n,o)&&o!==t&&A(n,o,{get:()=>e[o],enumerable:!(r=z(e,o))||r.enumerable});return n};var C=(n,e,t)=>(t=n!=null?R(q(n)):{},x(e||!n||!n.__esModule?A(t,"default",{value:n,enumerable:!0}):t,n)),G=n=>x(A({},"__esModule",{value:!0}),n);var Y={};J(Y,{default:()=>F});module.exports=G(Y);var I=require("@raycast/api"),l=require("react");var y=require("@raycast/api"),k=require("fs"),U=C(require("path"));function W(n){return!!U.default.normalize(n).startsWith("/System/")}function O(n){return n.filter(e=>W(e.path)===!1).sort((e,t)=>e.name.localeCompare(t.name))}async function v(n){return k.promises.access(n).then(()=>!0).catch(()=>!1)}function g(n,e="Error"){(0,y.showToast)({style:y.Toast.Style.Failure,title:e,message:n})}async function N(n=500){return new Promise(e=>setTimeout(e,n))}function L(n){return n!=null&&typeof n=="object"}function b(n,e){let t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(let o of t){let i=n[o],m=e[o],d=L(i)&&L(m);if(!d&&i!==m||d&&!b(i,m))return!1}return!0}var E=require("@raycast/api"),T=C(require("events"));var w=class{cache;emitter;constructor(){this.cache=new E.Cache,this.emitter=new T.default}async getApps(){let e=this.readCache();e.length&&(this.emitter.emit("update",e),await N()),(0,E.getApplications)().then(t=>O(t)).then(t=>this.enrich(t)).then(t=>{b(t,e)||(this.saveCache(t),this.emitter.emit("update",t))}).catch(t=>{console.error("Failed to fetch or process applications:",t),this.emitter.emit("error",t)})}enrich(e){let t=[];for(let r of e){let o=r.path.split("/").slice(1,-1).join("/"),i=r.bundleId?.split(".")[1]||"";i=i.charAt(0).toUpperCase()+i.slice(1),t.push({...r,brand:i,location:o})}return t}saveCache(e){this.cache.set("apps",JSON.stringify(e))}readCache(){let e=this.cache.get("apps");return e?JSON.parse(e):[]}};var S=require("@raycast/api"),j=require("child_process");var f=[{id:"appcleaner",name:"AppCleaner (by FreeMacSoft)",path:"/Applications/AppCleaner.app",url:"https://freemacsoft.net/appcleaner/",icon:"icon.png"},{id:"pearcleaner",name:"Pearcleaner",path:"/Applications/PearCleaner.app",url:"https://itsalin.com/appInfo/?id=pearcleaner",icon:"pearcleaner.png"},{id:"trashme",name:"TrashMe 3",path:"/Applications/TrashMe 3.app",url:"https://www.jibapps.com/apps/trashme",icon:"trashme.png"},{id:"appcleaneruninstaller",name:"App Cleaner & Uninstaller (by Nektony)",path:"/Applications/App Cleaner 8.app",url:"https://app-cleaner.com/",icon:"appcleaneruninstaller.png"}];var s=class n{static async getUninstaller(){let e=(0,S.getPreferenceValues)().uninstaller_app,t=Array.from(f);e&&t.sort((r,o)=>r.id===e?-1:o.id===e?1:0);for(let r of t)if(await v(r.path))return r}static checkDependencies(){return n.getUninstaller().then(e=>{if(!e)throw new Error("No uninstaller app found.");(0,S.updateCommandMetadata)({subtitle:"with "+e.name})})}static async launch(e){let t=await n.getUninstaller();return t?new Promise((r,o)=>{(0,j.exec)(`open -a "${t.path}" "${e.path}"`,i=>{if(i)return o(i);r()})}):Promise.reject(new Error("No uninstaller app found."))}};var a=require("@raycast/api");var u=require("react/jsx-runtime");function $({app:n}){function e(){s.launch(n).catch(t=>{g(t.toString())})}return(0,u.jsx)(a.List.Item,{title:n.name,subtitle:"by "+n.brand,accessories:[{text:"in "+n.location}],icon:{fileIcon:n.path},actions:(0,u.jsx)(a.ActionPanel,{children:(0,u.jsx)(a.ActionPanel.Section,{children:(0,u.jsx)(a.Action,{title:"Uninstall",onAction:e})})})})}var c=require("@raycast/api");var P=require("react/jsx-runtime");function D(){let n=`
# You need at least one of the following uninstallers installed:
${f.map(t=>`- [${t.name}](${t.url})`).join(`
`)}
`,e=f.map(t=>(0,P.jsx)(c.Action.OpenInBrowser,{icon:t.icon,title:`Get ${t.name}`,url:t.url},t.id));return(0,P.jsx)(c.Detail,{markdown:n,navigationTitle:"Error",actions:(0,P.jsx)(c.ActionPanel,{children:e})})}var h=require("react/jsx-runtime"),M=new w;function F(){let[n,e]=(0,l.useState)(!1),[t,r]=(0,l.useState)([]),[o,i]=(0,l.useState)(!0);(0,l.useEffect)(()=>{s.checkDependencies().then(()=>M.getApps()).catch(()=>e(!0)),M.emitter.on("update",m).on("error",d)},[]);function m(p){i(!1),r(p)}function d(p){i(!1),r([]),g(p.message,"Fetching applications failed.")}return n?(0,h.jsx)(D,{}):(0,h.jsx)(I.List,{isLoading:o,searchBarPlaceholder:"Search Applications...",children:(0,h.jsx)(I.List.Section,{title:"Results",subtitle:t?.length+"",children:t?.map(p=>(0,h.jsx)($,{app:p},p.path))})})}
